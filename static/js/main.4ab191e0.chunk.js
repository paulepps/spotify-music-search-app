(this["webpackJsonpspotify-music-search-app"]=this["webpackJsonpspotify-music-search-app"]||[]).push([[0],{83:function(e,t,r){},84:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r(0),s=r.n(n),c=r(17),i=r.n(c),o=r(19),l=r(22),u=r(49),j=r(20),b=r(11),d="SET_ALBUMS",p="ADD_ALBUMS",m="SET_ARTISTS",h="ADD_ARTISTS",O="SET_PLAYLIST",x="ADD_PLAYLIST",f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.albums;switch(t.type){case d:return r;case p:return Object(b.a)(Object(b.a)({},e),{},{next:r.next,items:[].concat(Object(j.a)(e.items),Object(j.a)(r.items))});default:return e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.artists;switch(t.type){case m:return r;case h:return Object(b.a)(Object(b.a)({},e),{},{next:r.next,items:[].concat(Object(j.a)(e.items),Object(j.a)(r.items))});default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.playlists;switch(t.type){case O:return r;case x:return Object(b.a)(Object(b.a)({},e),{},{next:r.next,items:[].concat(Object(j.a)(e.items),Object(j.a)(r.items))});default:return e}},g=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,_=Object(l.e)(Object(l.c)({albums:f,artists:y,playlist:v}),g(Object(l.a)(u.a))),S=r(15),E=r(21),T=r(6),w=r(87),k=r(86),C=function(){return Object(a.jsx)("h1",{className:"main-heading",children:"Spotify Music Search"})},A=Object(o.b)()((function(e){var t=Object({NODE_ENV:"production",PUBLIC_URL:"/spotify-music-search-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORIZE_URL:"https://accounts.spotify.com/authorize",REACT_APP_CLIENT_ID:"c698a4cd19524d8898eba12d04463720",REACT_APP_REDIRECT_URL:"http://paulepps.github.io/spotify-music-search-app/redirect"}),r=t.REACT_APP_CLIENT_ID,n=t.REACT_APP_AUTHORIZE_URL,s=t.REACT_APP_REDIRECT_URL,c=e.isValidSession,i=e.location.state,o=i&&i.session_expired;return Object(a.jsx)(a.Fragment,{children:c()?Object(a.jsx)(T.a,{to:"/dashboard"}):Object(a.jsxs)("div",{className:"login",children:[Object(a.jsx)(C,{}),o&&Object(a.jsx)(w.a,{variant:"info",children:"Session expired. Please login again."}),Object(a.jsx)(k.a,{variant:"info",type:"submit",onClick:function(){window.location="".concat(n,"?client_id=").concat(r,"&redirect_uri=").concat(s,"&response_type=token&show_dialog=true")},children:"Login to Spotify"})]})})})),N=r(10),L=r.n(N),I=r(27),R=r.n(I),P=function(){try{var e=JSON.parse(localStorage.getItem("params"));e&&(R.a.defaults.headers.common.Authorization="Bearer ".concat(e.access_token))}catch(t){console.log("Error setting auth",t)}},D=function(e){return Object(n.useEffect)((function(){var t=e.setExpiryTime,r=e.history,a=e.location;try{if(L.a.isEmpty(a.hash))return r.push("/dashboard");var n=a.hash.slice(1).split("&").reduce((function(e,t){var r=t.split("="),a=Object(S.a)(r,2),n=a[0],s=a[1];return e[n]=s,e}),{}),s=(new Date).getTime()+1e3*n.expires_in;localStorage.setItem("params",JSON.stringify(n)),localStorage.setItem("expiry_time",s),t(s),r.push("/dashboard")}catch(c){r.push("/")}})),null},U=r(8),B=r.n(U),V=r(18),F=function(){var e=Object(V.a)(B.a.mark((function e(t,r){var a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(),e.next=3,R.a.get(t,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),M=function(e){return{type:d,albums:e}},H=function(e){return{type:m,artists:e}},J=function(e){return{type:O,playlists:e}},K=function(e){return function(){var t=Object(V.a)(B.a.mark((function t(r){var a;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("url",e),t.next=4,F(e);case 4:return a=t.sent,console.log("categoriess",a),t.abrupt("return",r((n=a.albums,{type:p,albums:n})));case 9:t.prev=9,t.t0=t.catch(0),console.log("error",t.t0);case 12:case"end":return t.stop()}var n}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},W=function(e){return function(){var t=Object(V.a)(B.a.mark((function t(r){var a;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("url",e),t.next=4,F(e);case 4:return a=t.sent,console.log("categoriess",a),t.abrupt("return",r((n=a.artists,{type:h,artists:n})));case 9:t.prev=9,t.t0=t.catch(0),console.log("error",t.t0);case 12:case"end":return t.stop()}var n}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},q=function(e){return function(){var t=Object(V.a)(B.a.mark((function t(r){var a;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("url",e),t.next=4,F(e);case 4:return a=t.sent,console.log("categoriess",a),t.abrupt("return",r((n=a.playlists,{type:x,playlists:n})));case 9:t.prev=9,t.t0=t.catch(0),console.log("error",t.t0);case 12:case"end":return t.stop()}var n}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},z=r(88),X=function(e){var t=Object(n.useState)(""),r=Object(S.a)(t,2),s=r[0],c=r[1],i=Object(n.useState)(""),o=Object(S.a)(i,2),l=o[0],u=o[1];return Object(a.jsx)("div",{children:Object(a.jsxs)(z.a,{onSubmit:function(t){t.preventDefault(),""!==s.trim()?(u(""),e.handleSearch(s)):u("Please enter a search term.")},children:[l&&Object(a.jsx)("p",{className:"errorMsg",children:l}),Object(a.jsxs)(z.a.Group,{controlId:"formBasicEmail",children:[Object(a.jsx)(z.a.Label,{children:"Enter search term"}),Object(a.jsx)(z.a.Control,{type:"search",name:"searchTerm",value:s,placeholder:"Search for album, artist or playlist",onChange:function(e){var t=e.target.value;c(t)},autoComplete:"off"})]}),Object(a.jsx)(k.a,{variant:"info",type:"submit",children:"Search"})]})})},Y=r(89),Z=r.p+"static/media/music.b2fe7d4d.jpeg",G=function(e){var t=e.albums;return Object(a.jsx)(a.Fragment,{children:Object.keys(t).length>0&&Object(a.jsx)("div",{className:"albums",children:t.items.map((function(e,t){return Object(a.jsx)(s.a.Fragment,{children:Object(a.jsxs)(Y.a,{style:{width:"18rem"},children:[Object(a.jsx)("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link",children:L.a.isEmpty(e.images)?Object(a.jsx)("img",{src:Z,alt:""}):Object(a.jsx)(Y.a.Img,{variant:"top",src:e.images[0].url,alt:""})}),Object(a.jsxs)(Y.a.Body,{children:[Object(a.jsx)(Y.a.Title,{children:e.name}),Object(a.jsx)(Y.a.Text,{children:Object(a.jsx)("small",{children:e.artists.map((function(e){return e.name})).join(", ")})})]})]})},t)}))})})},Q=function(e){var t=e.artists;return Object(a.jsx)(a.Fragment,{children:Object.keys(t).length>0&&Object(a.jsx)("div",{className:"artists",children:t.items.map((function(e,t){return Object(a.jsx)(s.a.Fragment,{children:Object(a.jsxs)(Y.a,{style:{width:"18rem"},children:[Object(a.jsx)("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link",children:L.a.isEmpty(e.images)?Object(a.jsx)("img",{src:Z,alt:""}):Object(a.jsx)(Y.a.Img,{variant:"top",src:e.images[0].url,alt:""})}),Object(a.jsx)(Y.a.Body,{children:Object(a.jsx)(Y.a.Title,{children:e.name})})]})},t)}))})})},$=function(e){var t=e.playlist;return Object(a.jsx)("div",{children:Object.keys(t).length>0&&Object(a.jsx)("div",{className:"playlist",children:t.items.map((function(e,t){return Object(a.jsx)(s.a.Fragment,{children:Object(a.jsxs)(Y.a,{style:{width:"18rem"},children:[Object(a.jsx)("a",{target:"_blank",href:e.external_urls.spotify,rel:"noopener noreferrer",className:"card-image-link",children:L.a.isEmpty(e.images)?Object(a.jsx)("img",{src:Z,alt:""}):Object(a.jsx)(Y.a.Img,{variant:"top",src:e.images[0].url,alt:""})}),Object(a.jsxs)(Y.a.Body,{children:[Object(a.jsx)(Y.a.Title,{children:e.name}),Object(a.jsx)(Y.a.Text,{children:Object(a.jsxs)("small",{children:["By ",e.owner.display_name]})})]})]})},t)}))})})},ee=function(e){var t=e.loadMore,r=e.result,n=e.setCategory,s=e.selectedCategory,c=r.albums,i=r.artists,o=r.playlist;return e.isValidSession()?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"search-buttons",children:[!L.a.isEmpty(c.items)&&Object(a.jsx)("button",{className:"".concat("albums"===s?"btn active":"btn"),onClick:function(){return n("albums")},children:"Albums"}),!L.a.isEmpty(i.items)&&Object(a.jsx)("button",{className:"".concat("artists"===s?"btn active":"btn"),onClick:function(){return n("artists")},children:"Artists"}),!L.a.isEmpty(o.items)&&Object(a.jsx)("button",{className:"".concat("playlist"===s?"btn active":"btn"),onClick:function(){return n("playlist")},children:"PlayLists"})]}),Object(a.jsx)("div",{className:"".concat("albums"===s?"":"hide"),children:c&&Object(a.jsx)(G,{albums:c})}),Object(a.jsx)("div",{className:"".concat("artists"===s?"":"hide"),children:i&&Object(a.jsx)(Q,{artists:i})}),Object(a.jsx)("div",{className:"".concat("playlist"===s?"":"hide"),children:o&&Object(a.jsx)($,{playlist:o})}),!L.a.isEmpty(r[s])&&!L.a.isEmpty(r[s].next)&&Object(a.jsx)("div",{className:"load-more",onClick:function(){return t(s)},children:Object(a.jsx)(k.a,{variant:"info",type:"button",children:"Load More"})})]}):Object(a.jsx)(T.a,{to:{pathname:"/",state:{session_expired:!0}}})},te=function(e){var t=Object(n.useState)(document.createElement("div")),r=Object(S.a)(t,1)[0],a=document.querySelector("#loader");return Object(n.useEffect)((function(){a.appendChild(r).classList.add("message")}),[a,r]),Object(n.useEffect)((function(){e.show?(a.classList.remove("hide"),document.body.classList.add("loader-open")):(a.classList.add("hide"),document.body.classList.remove("loader-open"))}),[a,e.show]),i.a.createPortal(e.children,r)},re=function(e){var t=Object(n.useState)(!1),r=Object(S.a)(t,2),s=r[0],c=r[1],i=Object(n.useState)("albums"),l=Object(S.a)(i,2),u=l[0],j=l[1],b=Object(o.c)(),d=Object(o.d)((function(e){return e.albums})),p=Object(o.d)((function(e){return e.artists})),m=Object(o.d)((function(e){return e.playlist})),h=e.isValidSession,O=e.history,x=function(){var e=Object(V.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h()){e.next=17;break}c(!0),e.t0=t,e.next="albums"===e.t0?5:"artists"===e.t0?8:"playlist"===e.t0?11:14;break;case 5:return e.next=7,b(K(d.next));case 7:return e.abrupt("break",14);case 8:return e.next=10,b(W(p.next));case 10:return e.abrupt("break",14);case 11:return e.next=13,b(q(m.next));case 13:return e.abrupt("break",14);case 14:c(!1),e.next=18;break;case 17:O.push({pathname:"/",state:{session_expired:!0}});case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f={albums:d,artists:p,playlist:m};return h?Object(a.jsxs)("div",{children:[Object(a.jsx)(C,{}),Object(a.jsx)(X,{handleSearch:function(e){h()?(c(!0),b(function(e){return function(){var t=Object(V.a)(B.a.mark((function t(r){var a,n,s,c,i;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a="https://api.spotify.com/v1/search?query=".concat(encodeURIComponent(e),"&type=album,playlist,artist"),t.next=4,F(a);case 4:return n=t.sent,console.log(n),s=n.albums,c=n.artists,i=n.playlists,r(M(s)),r(H(c)),t.abrupt("return",r(J(i)));case 12:t.prev=12,t.t0=t.catch(0),console.log("error",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}(e)).then((function(){c(!1),j("albums")}))):O.push({pathname:"/",state:{session_expired:!0}})}}),Object(a.jsx)(te,{show:s,children:"Loading..."}),Object(a.jsx)(ee,{result:f,loadMore:x,setCategory:function(e){j(e)},selectedCategory:u,isValidSession:h})]}):Object(a.jsx)(T.a,{to:{pathname:"/",state:{session_expired:!0}}})},ae=function(){var e=Object(n.useState)({expiryTime:"0"}),t=Object(S.a)(e,2),r=t[0],s=t[1];Object(n.useEffect)((function(){var e;try{e=JSON.parse(localStorage.getItem("expiry_time"))}catch(t){e="0"}s({expiryTime:e})}),[]);var c=function(e){s({expiryTime:e})},i=function(){return(new Date).getTime()<r.expiryTime};return Object(a.jsx)(E.a,{basename:"/spotify-music-search-app",children:Object(a.jsx)("div",{className:"main",children:Object(a.jsxs)(T.d,{children:[Object(a.jsx)(T.b,{path:"/",exact:!0,render:function(e){return Object(a.jsx)(A,Object(b.a)({isValidSession:i},e))}}),Object(a.jsx)(T.b,{path:"/redirect",exact:!0,render:function(e){return Object(a.jsx)(D,Object(b.a)({isValidSession:i,setExpiryTime:c},e))}}),Object(a.jsx)(T.b,{path:"/dashboard",exact:!0,render:function(e){return Object(a.jsx)(re,Object(b.a)({isValidSession:i},e))}}),Object(a.jsx)(T.b,{render:function(e){return Object(a.jsx)(A,Object(b.a)({isValidSession:i},e))}})]})})})};r(82),r(83);i.a.render(Object(a.jsx)(o.a,{store:_,children:Object(a.jsx)(ae,{})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.4ab191e0.chunk.js.map